"use strict";(self.webpackChunkIIT_Bhilai=self.webpackChunkIIT_Bhilai||[]).push([[986],{986:(e,t,a)=>{a.r(t),a.d(t,{default:()=>u});var r=a(791),l=a(659),s=a(418),d=a(355),o=a(85),n=a(380),i=a(282),c=a(184);const u=()=>{const{paperList:e}=(0,r.useContext)(s.Z),[t,a]=(0,r.useState)([]),[u,b]=(0,r.useState)(""),[m,p]=(0,r.useState)(""),[h,x]=(0,r.useState)(""),[v,f]=(0,r.useState)(""),[g,k]=(0,r.useState)(!0),[j,w]=(0,r.useState)(""),N=async e=>{a([]),f(""),e.preventDefault(),f("");try{const e=await l.Z.get(`/attendance/${u}/${m}/${h}`);w(e.data._id),a(e.data.attendance),k(!0)}catch(t){if(f(t),404===t.response.status){const e=(await l.Z.get("paper/"+u)).data.students;e.forEach((e=>{Object.assign(e,{present:!0})})),a(e),k(!1)}}},y=e=>{const r=parseInt(e.target.id),l=t[r];l.present=!l.present;const s=t.map(((t,a)=>(parseInt(e.target.id),t)));a(s)};return(0,c.jsxs)("main",{className:"attendance",children:[(0,c.jsx)("h2",{className:"mb-2 mt-3 whitespace-break-spaces text-4xl font-bold text-violet-950 underline decoration-inherit decoration-2 underline-offset-4 dark:mt-0 dark:text-slate-400 md:text-6xl",children:"Attendance"}),(0,c.jsx)("section",{className:"attendance__head",children:(0,c.jsxs)("form",{className:"w-full gap-4 accent-violet-900 md:flex ",children:[(0,c.jsxs)("div",{className:"flex w-full flex-col",children:[(0,c.jsx)("label",{className:"m-1",htmlFor:"paper",children:"Select Paper"}),(0,c.jsxs)("select",{className:"mb-4 block h-10  rounded-md border-[1.5px] border-solid border-slate-400 p-1 pl-2 outline-none selection:border-slate-200 focus:border-violet-900 dark:border-slate-200 dark:caret-inherit dark:focus:border-violet-400 dark:active:border-violet-400 ",name:"paper",id:"paper",value:u,required:!0,onChange:e=>b(e.target.value),children:[(0,c.jsx)("option",{defaultValue:!0,hidden:!0,children:"---"}),e.map(((e,t)=>(0,c.jsx)("option",{value:e._id,children:e.paper},t)))]})]}),(0,c.jsxs)("div",{className:"flex w-full flex-col",children:[(0,c.jsx)("label",{className:"m-1",htmlFor:"date",children:"Select Date"}),(0,c.jsx)("input",{className:"mb-4 block h-10 w-full rounded-md border-[1.5px] border-solid border-slate-400 p-1 pl-2 outline-none selection:border-slate-200 focus:border-violet-900 dark:border-slate-200 dark:caret-inherit dark:focus:border-violet-400 dark:active:border-violet-400",id:"date",type:"date",name:"date",value:m,onChange:e=>p(e.target.value)})]}),(0,c.jsxs)("div",{className:"flex w-full flex-col",children:[(0,c.jsx)("label",{className:"m-1",htmlFor:"hour",children:"Select Hour"}),(0,c.jsxs)("select",{className:"mb-4 h-10 w-full rounded-md border-[1.5px] border-solid border-slate-400 p-1 pl-2 outline-none selection:border-slate-200 focus:border-violet-900 dark:border-slate-200 dark:caret-inherit dark:focus:border-violet-400 dark:active:border-violet-400",name:"hour",id:"hour",value:h,required:!0,onChange:e=>x(e.target.value),children:[(0,c.jsx)("option",{defaultValue:!0,hidden:!0,children:"---"}),(0,c.jsx)("option",{value:"1",children:"I"}),(0,c.jsx)("option",{value:"2",children:"II"}),(0,c.jsx)("option",{value:"3",children:"III"}),(0,c.jsx)("option",{value:"4",children:"IV"}),(0,c.jsx)("option",{value:"5",children:"V"})]})]}),(0,c.jsx)("div",{className:"flex items-end",children:(0,c.jsx)("button",{className:" mb-4 h-10 rounded-md border-[1.5px] border-solid border-violet-900 bg-slate-800 px-8 py-2 font-semibold tracking-wide text-slate-200 hover:bg-violet-900 focus:bg-violet-900 disabled:cursor-not-allowed dark:border-violet-300 dark:bg-violet-900 dark:text-violet-100 dark:hover:bg-slate-900 md:w-auto",type:"submit",onClick:e=>N(e),children:"Fetch"})})]})}),(0,c.jsx)("div",{children:v?(0,c.jsx)(i.Z,{error:v}):""}),(0,c.jsx)("section",{className:"attendance__form",children:(0,c.jsxs)("form",{className:"w-full",children:[null!==t&&void 0!==t&&t.length?(0,c.jsx)("div",{className:"my-4 w-full rounded-md border-2 border-slate-900 dark:border-slate-500 dark:p-[1px] lg:w-1/2",children:(0,c.jsxs)("table",{className:"w-full",children:[(0,c.jsx)(n.x,{Headers:["Present","Student"]}),(0,c.jsx)("tbody",{children:null===t||void 0===t?void 0:t.map(((e,t)=>(0,c.jsx)(n.Q,{keys:t,disabled:g,value:e,handleFormChange:y},t)))})]})}):"",t.length&&g?(0,c.jsxs)("div",{className:"flex gap-4",children:[(0,c.jsxs)("button",{type:"submit",className:"mb-4 flex h-10 w-auto items-center gap-2 rounded-md border-[1.5px] border-solid border-violet-900 bg-slate-800 px-6 py-2 font-semibold tracking-wide text-slate-200 hover:bg-violet-900 focus:bg-violet-900 dark:border-violet-300 dark:bg-violet-900 dark:text-violet-100 dark:hover:bg-slate-900",onClick:e=>k(!1),children:[(0,c.jsx)(d.fmQ,{})," Edit"]}),(0,c.jsxs)("button",{type:"submit",className:"mb-4 flex h-10 w-auto items-center gap-2 rounded-md border-[1.5px] border-solid border-violet-900 bg-slate-800 px-4 py-2 font-semibold tracking-wide text-slate-200 hover:bg-red-700 focus:bg-violet-900 dark:border-violet-300 dark:bg-violet-900 dark:text-violet-100 dark:hover:bg-red-700",onClick:e=>(async e=>{e.preventDefault();try{const e=await l.Z.delete("attendance/"+j);o.Am.success(e.data.message,{icon:e=>{let{theme:t,type:a}=e;return(0,c.jsx)(d.Xm5,{})}}),a([])}catch(t){f(t)}})(e),children:[(0,c.jsx)(d.Xm5,{})," Delete"]})]}):"",null!==t&&void 0!==t&&t.length&&!g?(0,c.jsxs)("button",{type:"submit",className:"mb-4 flex h-10 w-auto items-center gap-2 rounded-md border-[1.5px] border-solid border-violet-900 bg-slate-800 px-4 py-2 font-semibold tracking-wide text-slate-200 hover:bg-violet-900 focus:bg-violet-900 dark:border-violet-300 dark:bg-violet-900 dark:text-violet-100 dark:hover:bg-slate-900 ",onClick:e=>(async e=>{e.preventDefault();const a=t.map((e=>({student:e._id,present:e.present})));try{const t=await l.Z.post(`/attendance/${u}/${m}/${h}`,{paper:u,date:m,hour:h,attendance:a});o.Am.success(t.data.message),k(!0),f(""),N(e)}catch(r){if(409===(null===r||void 0===r?void 0:r.response.status)){const a=t.map((e=>({student:e.student._id,present:e.present})));try{const t=await l.Z.patch(`/attendance/${u}/${m}/${h}`,{id:j,paper:u,date:m,hour:h,attendance:a});o.Am.success(t.data.message),k(!0),f(""),N(e)}catch(r){f(r)}}else f(r)}})(e),children:[(0,c.jsx)(d.wEH,{})," Save"]}):""]})})]})}}}]);
//# sourceMappingURL=986.d4060f72.chunk.js.map